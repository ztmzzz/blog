---
title: 使用sandboxie-plus隔离QQ和微信
date: 2022-07-25 21:32:54
tags: 
---

# 前提准备

购买sandboxie-plus的捐赠版本，一年18欧元，或者{% post_link 破解sandboxie-plus 破解版 %}

绿化版或原版安装包

以下均以v1.1.3捐赠版本为例

# 沙盒配置

## 基础配置

新建一个数据保护加固型沙盒，确认勾选以下选项

> 常规选项-管理员权限-撤销管理员和Power Users用户组的权限
> 
> 常规选项-管理员权限-使应用程序认为自己已被提权运行
> 
> 资源访问-资源访问权限策略-隐私模式

如果想要将QQ微信程序或者聊天记录等放在主机上而不是沙盒的文件夹内，那么在`资源访问-资源访问权限规则`中添加路径，并选择开放权限。这样就相当于在沙箱上面打了个洞，QQ微信能直接访问这些文件，而不是访问沙箱内的虚拟文件(默认存放在Sandbox文件夹中)

在`资源访问-资源访问权限规则`中添加安装包或绿化版所在的路径，选择开放权限。也可以放置在`C:\Sandbox\YOUR-ID\SANDBOX-ID\user\Public`下(YOUR-ID和SANDBOX-ID取决于你的用户名和沙箱名字)，只要沙箱内能访问到就行，安装完后可以直接删除

在`C:\Sandbox\YOUR-ID\SANDBOX-ID\user\current`下创建`Desktop`文件夹，这样可以避免QQ微信的资源管理器白屏

如果想要把聊天记录放在沙箱中就再创建一个`Documents`文件夹

按照正常流程打开安装包或者绿化版既可。注意绿化版直接打开源文件既可，不需要也没有权限绿化

在`必沙程序`中添加QQ微信程序所在的目录，如果安装在沙盒内就跳过

在`停止行为`中添加`引导程序`为`WeChat.exe`或者`QQ.exe`，这样在QQ微信退出的时候，沙盒内所有程序都会退出

推荐勾选`常规选项-文件选项-沙盒删除选项-保护此沙盒受删除或清空`，防止不小心删除

大功告成！QQ微信的所有操作都不会影响到真实系统的对应文件，只会修改沙盒文件夹内的数据

## 高级配置

这样配置完之后打开沙箱的资源管理器一看，发现还是能够访问到`C:\Program Files`,`C:\Program Files (x86)`,`C:\Windows`，不过QQ微信对这些都是只读的，更改不会影响到真实系统。如果不想让QQ微信访问到这些文件夹里面的内容，可以增加以下设置

由于QQ微信是需要使用`Program Files`这些文件夹里面的某些程序的，因此不能直接屏蔽`C:\Program Files\*`，那如果在加上允许`C:\Program Files\xxxx`可以么？

按照sandboxie-plus的特异性规则来说按理是可行的，因为允许的规则特异性高，应当优先匹配。不过实际上会导致整个`Program Files`无法访问，没有效果。因此QQ微信是无论如何都能看到你安装的程序名的，能做的只是屏蔽他们进一步查看里面的内容。

对于想要隐藏的程序，以7-Zip为例，添加`C:\Program Files\7-Zip`的封锁权限，不过程序太多，更好的办法是直接修改沙盒的配置文本，加上`ClosedFilePath=C:\Program Files\7-Zip`。搭配`ls`指令，可以方便的生成配置文件，不过要注意不能将QQ微信需要的文件夹屏蔽了，这就需要自己尝试了。
